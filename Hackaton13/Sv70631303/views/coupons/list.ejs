<div class="d-flex justify-content-between align-items-center mb-4">
  <h2>Administrar Cupones</h2>
  <a href="/coupons/create" class="btn btn-success">
    <i class="fas fa-plus"></i> Nuevo Cupón
  </a>
</div>

<div class="table-responsive">
  <table class="table table-striped table-hover">
    <thead class="table-dark">
      <tr>
        <th>Código</th>
        <th>Descripción</th>
        <th>Descuento</th>
        <th>Válido</th>
        <th>Usos</th>
        <th>Estado</th>
        <th>Acciones</th>
      </tr>
    </thead>
    <tbody>
      <% coupons.forEach(coupon => { %>
        <tr>
          <td><strong><%= coupon.code %></strong></td>
          <td><%= coupon.description %></td>
          <td>
            <% if (coupon.discountType === 'percentage') { %>
              <%= coupon.discountValue %>% descuento
            <% } else { %>
              $<%= coupon.discountValue.toFixed(2) %> descuento
            <% } %>
          </td>
          <td>
            <%= coupon.validFrom.toLocaleDateString() %> - <%= coupon.validUntil.toLocaleDateString() %>
          </td>
          <td>
            <%= coupon.usedCount %> / <%= coupon.usageLimit || '∞' %>
          </td>
          <td>
            <% if (coupon.isActive) { %>
              <span class="badge bg-success">Activo</span>
            <% } else { %>
              <span class="badge bg-secondary">Inactivo</span>
            <% } %>
          </td>
          <td>
            <a href="/coupons/<%= coupon._id %>/edit" class="btn btn-sm btn-warning">
              <i class="fas fa-edit"></i>
            </a>
            <% if (user.role === 'admin') { %>
              <form action="/coupons/<%= coupon._id %>?_method=DELETE" method="POST" class="d-inline">
                <button type="submit" class="btn btn-sm btn-danger">
                  <i class="fas fa-trash"></i>
                </button>
              </form>
            <% } %>
          </td>
        </tr>
      <% }) %>
    </tbody>
  </table>
</div>

<% if (totalPages > 1) { %>
  <nav aria-label="Page navigation">
    <ul class="pagination justify-content-center">
      <% for (let i = 1; i <= totalPages; i++) { %>
        <li class="page-item <%= currentPage == i ? 'active' : '' %>">
          <a class="page-link" href="?page=<%= i %>"><%= i %></a>
        </li>
      <% } %>
    </ul>
  </nav>
<% } %>